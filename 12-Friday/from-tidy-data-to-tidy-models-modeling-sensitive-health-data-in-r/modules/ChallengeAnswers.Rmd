---
title: "Challenge_answers"
author: "Brooke Wolford"
date: "2025-12-04"
output: html_document
---

  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#load packages
library(dplyr)
library(readr)
library(tidyr)
```

# Challenge Answers

### Module 1 Challenge

Task: Given a simple data frame of patients with ID, sex, age, and cholesterol values in two visits, write code to:
	1.	Filter patients over 45 years and save to a new dataset called sub, how many are there?
	2.  Select ID, Sex, and Cholesterol columns to a new dataset called sub2.
	3.	Using sub2, create a new variable that is 1 if the patient has high cholesterol (over 200), and 0 otherwise. Save this to a datset called high.
	4.	Using sub2, summarize average cholesterol by sex

```{r}

df <- data.frame(
  ID = 1:8,
  Age = c(34, 60, 45, 50, 29, 80, 55, 65),
  SBP = c(120, 140, 135, 150, 110, 140, 120, 125 ),
  cholesterol = c(200,220, 190, 195, 180, 240, 230, 235),
  sex = c("Male","Male","Female","Male","Female","Female","Male","Male")
)

# Filter patients over 45 and save to a new dataset named sub
sub<-df %>% filter(Age>45)

# How many patients are over 45?
nrow(sub)

# In the original dataset, select the ID, sex, and cholesterol column for a new dataset
sub2<-df %>% select(ID,sex,cholesterol)

# Create a new variable (indicator variable) showing whether cholesterol is above 200
sub3<-sub2 %>% mutate(high=ifelse(cholesterol>200,1,0))

# Summarize average cholesterol by sex
sub2 %>% group_by(sex) %>%summarise(mean_chol=mean(cholesterol))


```


### Module 2 Challenge

Remember what we did before. In the Files tab on the bottom right panel, navigate to the folder `from-tidy-data-to-tidy-models-modeling-sensitive-health-data-in-r`. Click on  "More" and select "Copy Folder Path to Clipboard." Paste that path below where it says "PASTE HERE". Be sure to keep the quotations and remove the hashtag.


Task: Given a data frame of patients' inflammatory measures over time, create a plot that shows these measurements over time, stratified by patient. I have already downloaded the [data from Software](https://swcarpentry.github.io/r-novice-inflammation/data/r-novice-inflammation-data.zip) in the data directory.
	0. Read in the data with `read_csv`
	1. Use `mutate()` to add a sample ID column
	2. Turn the data from wide to long with `pivot_longer()`
	3. Turn the column that represents time points into numeric
	4. Create a line plot `ggplot2`; inflammation should be on the y-axis, timepoint should be on the x-axis. Use `facet_wrap()` to separate by sample ID.
	5. Export the plot with `ggsave()`

```{r eval="false"}

#define the path to the data
#path<-"PASTE HERE"
path3<-paste0(path,"/data/inflammation-01.csv")

#read in the inflammation data as a tibble using the path3 variable. Note that the file does not include column names.
idf<-read_csv(path3,col_names=FALSE)

# use mutate to create a sample ID column
idf<-idf %>% mutate(ID=row.names(df))
idf %>% select(ID)

# use pivot_longer to restructure the data
longdf<-idf %>% pivot_longer(cols=X1:X40,
                     names_to="timepoint",
                     values_to="inflammation")


# turn the timepoint column from character to numeric
longdf <- longdf %>% mutate(timepoint_num=as.numeric(sub("^X", "", timepoint)))

# HINT mutate(timepoint_num=as.numeric(sub("^X", "", timepoint)))

#create a plot with one line per sample
g<-ggplot(longdf,aes(x=timepoint_num,y=inflammation)) + geom_line() + facet_wrap(~ID)
g

#export the plot with ggsave()

#set a path to save the file to
output_path<-paste0(path,"/inflammation.png")
ggsave(filename = output_path, plot = g, width = 12, height = 12, dpi = 300, units = "cm")


```

